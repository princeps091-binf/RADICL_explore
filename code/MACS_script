# select relevant DNA columns in RADICL bed file
cut -d$'\t' -f7-11 15.AGTTCC.2.bed > Set18-7_iPSC_rep2_AGTTCC_S0_L002_R1_001_DNA.bed
awk '/chr19/ {print}' Set18-7_iPSC_rep2_AGTTCC_S0_L002_R1_001_DNA.bed 
# 
macs3 callpeak  -f BED --nomodel --shift -37 --extsize 75 -t Set18-7_iPSC_rep2_AGTTCC_S0_L002_R1_001_DNA.bed > test.bed
# Size of full nucleosome
macs3 callpeak  -f BED --nomodel --shift -72 --extsize 147 -t Set18-7_iPSC_rep2_AGTTCC_S0_L002_R1_001_DNA_chr19.bed -B -n chr19_nucleosome

macs3 pileup -f BED -i Set18-7_iPSC_rep2_AGTTCC_S0_L002_R1_001_DNA.bed --extsize 25 -o RADICL_DNA_track.bdg

macs3 pileup -f BED -i Set18-Set18-7_iPSC_rep2_AGTTCC_S0_L002_R1_001_DNA_chr19.bed --extsize 1000000 -o RADICL_DNA_track.bdg

macs3 pileup -f BED -i BCL3_GM12878_ENCFF629LEU_sorted_chr19.bed --extsize 1000000 -o BCL3_GM12878_ENCFF629LEU_sorted_chr19.bdg

## Smmothing signal
# 147/1e3 = 
macs3 pileup -f BED -i Set18-7_iPSC_rep2_AGTTCC_S0_L002_R1_001_DNA.bed --extsize 500 -o smooth_RADICL_DNA_track.bdg
macs3 bdgopt -i smooth_RADICL_DNA_track.bdg -m multiply -p 0.147 -o smooth_RADICL_DNA_track_norm.bdg

###############################################
samtools sort -o ENCFF962FMH.bam_sorted.bam ENCFF962FMH.bam.bam 
samtools index ENCFF962FMH_sorted.bam 
samtools view -b ENCFF962FMH_sorted.bam chr19 > GM12878_ATAC_ENCFF962FMH_sorted_chr19.bam
~/bedtools2.3 bamtobed -bed12 -i GM12878_ATAC_ENCFF962FMH_sorted_chr19.bam > GM12878_ATAC_ENCFF962FMH_sorted_chr19.bed
macs3 pileup -f BED -i GM12878_ATAC_ENCFF962FMH_sorted_chr19.bed --extsize 1000000 -o GM12878_ATAC_ENCFF962FMH_sorted_chr19.bdg
